<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEST 고객 시스템 점검 보고서</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', 'Malgun Gothic', sans-serif;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid #eee;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #004d99, #0073e6);
            color: white;
            border-radius: 5px;
        }
        h1 {
            margin: 0;
            font-size: 2.2em;
        }
        h2 {
            color: #0056b3;
            margin-top: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        h3 {
            color: #007bff;
        }
        .report-meta {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .summary-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            flex: 1 1 200px;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .card-title {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: #555;
        }
        .card-value {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .card-good {
            background-color: #d4edda;
            border-left: 5px solid #28a745;
        }
        .card-warning {
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
        }
        .card-danger {
            background-color: #f8d7da;
            border-left: 5px solid #dc3545;
        }
        .card-info {
            background-color: #d1ecf1;
            border-left: 5px solid #17a2b8;
        }
        .chart-container {
            position: relative;
            margin: 20px 0 40px 0;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 5px;
            background-color: white;
        }
        .chart-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-col {
            flex: 1 1 45%;
            min-width: 300px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: 600;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .severity-critical {
            color: #dc3545;
            font-weight: bold;
        }
        .severity-warning {
            color: #ffc107;
            font-weight: bold;
        }
        .severity-normal {
            color: #28a745;
        }
        .status-complete {
            color: #28a745;
            font-weight: bold;
        }
        .status-inprogress {
            color: #007bff;
            font-weight: bold;
        }
        .status-critical {
            color: #dc3545;
            font-weight: bold;
        }
        .status-warning {
            color: #ffc107;
            font-weight: bold;
        }
        .recommendations {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 30px 0;
        }
        .recommendations ul {
            padding-left: 20px;
        }
        .recommendations li {
            margin-bottom: 10px;
        }
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            border-top: 1px solid #eee;
            color: #777;
        }
        @media (max-width: 768px) {
            .chart-col {
                flex: 1 1 100%;
            }
            .card {
                flex: 1 1 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>TEST 고객 시스템 점검 보고서</h1>
            <p>NMSGLOBAL NMS 시스템 상태 분석</p>
        </header>

        <div class="report-meta">
            <div>
                <strong>고객명:</strong> TEST
                <br>
                <strong>대상 시스템:</strong> NMSGLOBAL-96228
            </div>
            <div>
                <strong>보고서 기간:</strong> <span id="reportPeriod"></span>
                <br>
                <strong>생성일:</strong> <span id="generatedDate"></span>
            </div>
        </div>

        <h2>📊 요약 정보</h2>
        
        <div class="summary-cards">
            <div class="card card-good">
                <div class="card-title">시스템 가동률</div>
                <div class="card-value" id="avgAvailability">100%</div>
            </div>
            <div class="card card-danger">
                <div class="card-title">평균 메모리 사용률</div>
                <div class="card-value" id="avgMemoryUsage">75.3%</div>
            </div>
            <div class="card card-danger">
                <div class="card-title">C드라이브 사용률</div>
                <div class="card-value" id="cDriveUsage">96.6%</div>
            </div>
            <div class="card card-danger">
                <div class="card-title">심각 이벤트</div>
                <div class="card-value" id="totalCritical">1</div>
            </div>
        </div>

        <div class="summary-cards">
            <div class="card card-info">
                <div class="card-title">D드라이브 사용률</div>
                <div class="card-value" id="dDriveUsage">9.4%</div>
            </div>
            <div class="card card-danger">
                <div class="card-title">Z드라이브 사용률</div>
                <div class="card-value" id="zDriveUsage">86.9%</div>
            </div>
            <div class="card card-info">
                <div class="card-title">활성 장치</div>
                <div class="card-value" id="deviceCount">20</div>
            </div>
            <div class="card card-danger">
                <div class="card-title">마지막 백업</div>
                <div class="card-value" id="lastBackup">25일 전</div>
            </div>
        </div>

        <h2>📈 시스템 성능 모니터링</h2>
        
        <div class="chart-row">
            <div class="chart-col">
                <div class="chart-container">
                    <canvas id="memoryChart"></canvas>
                </div>
            </div>
            <div class="chart-col">
                <div class="chart-container">
                    <canvas id="driveChart"></canvas>
                </div>
            </div>
        </div>

        <div class="chart-row">
            <div class="chart-col">
                <div class="chart-container">
                    <canvas id="virtualMemoryChart"></canvas>
                </div>
            </div>
            <div class="chart-col">
                <div class="chart-container">
                    <canvas id="servicesChart"></canvas>
                </div>
            </div>
        </div>

        <h2>🔍 이벤트 로그 분석</h2>
        
        <table>
            <thead>
                <tr>
                    <th>일자</th>
                    <th>심각도</th>
                    <th>이벤트 유형</th>
                    <th>설명</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>2025-05-08 19:16:48</td>
                    <td class="severity-critical">심각</td>
                    <td>Agent Unavailable</td>
                    <td>Agent nmsglobal-96228 became unavailable</td>
                </tr>
                <tr>
                    <td>2025-05-10</td>
                    <td class="severity-critical">심각</td>
                    <td>전체 메모리 사용률</td>
                    <td>메모리 사용률 80% 초과 (80.07%)</td>
                </tr>
                <tr>
                    <td>2025-05-10</td>
                    <td class="severity-critical">심각</td>
                    <td>디스크 공간</td>
                    <td>C드라이브 가용 공간 3.4GB (사용률 96.58%)</td>
                </tr>
                <tr>
                    <td>2025-05-10</td>
                    <td class="severity-critical">심각</td>
                    <td>백업 상태</td>
                    <td>마지막 백업 날짜: 2025-04-15 (25일 경과)</td>
                </tr>
                <tr>
                    <td>2025-05-10</td>
                    <td class="severity-warning">경고</td>
                    <td>디스크 공간</td>
                    <td>Z드라이브 사용률 87.77% - 임계치 접근</td>
                </tr>
            </tbody>
        </table>

        <h2>🛠️ 시스템 점검 결과</h2>
        
        <table>
            <thead>
                <tr>
                    <th>점검 항목</th>
                    <th>상태</th>
                    <th>점검 결과</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>서버 운영체제 점검</td>
                    <td class="status-complete">완료</td>
                    <td>Windows Server 2019 Standard 정상 작동 중</td>
                </tr>
                <tr>
                    <td>SolarWinds 엔진 점검</td>
                    <td class="status-complete">완료</td>
                    <td>SolarWinds Orion Core Services 2020.2.6 정상 작동</td>
                </tr>
                <tr>
                    <td>데이터베이스 시스템</td>
                    <td class="status-complete">완료</td>
                    <td>Microsoft SQL Server 2019 Express Edition 정상 작동 (11.99 GB 사용)</td>
                </tr>
                <tr>
                    <td>주요 서비스 상태</td>
                    <td class="status-complete">완료</td>
                    <td>모든 주요 서비스 정상 가동 중</td>
                </tr>
                <tr>
                    <td>메모리 사용률</td>
                    <td class="status-critical">위험</td>
                    <td>메모리 사용률 80.07% - 즉시 대응 필요</td>
                </tr>
                <tr>
                    <td>디스크 공간 점검</td>
                    <td class="status-critical">위험</td>
                    <td>C드라이브 96.58% 사용중 - 즉시 대응 필요</td>
                </tr>
                <tr>
                    <td>백업 시스템 점검</td>
                    <td class="status-critical">위험</td>
                    <td>25일간 백업 미수행 - 즉시 백업 필요</td>
                </tr>
                <tr>
                    <td>Windows Update 상태</td>
                    <td class="status-complete">정상</td>
                    <td>Windows Update 서비스 정상 실행 중 (최근 업데이트: KB5055175)</td>
                </tr>
            </tbody>
        </table>

        <h2>📋 권장 사항</h2>
        
        <div class="recommendations">
            <ul>
                <li><strong>긴급 - C드라이브 용량 확보:</strong> C드라이브 사용률이 96.58%로 위험 수준입니다. 즉시 불필요한 파일 정리 및 용량 확보가 필요합니다.</li>
                <li><strong>긴급 - 백업 시스템 점검:</strong> 마지막 백업이 25일 전입니다. 백업 스케줄러 점검 및 즉시 수동 백업을 권장합니다.</li>
                <li><strong>긴급 - 메모리 사용률 개선:</strong> 메모리 사용률이 80%를 초과했습니다. 불필요한 프로세스 종료 및 메모리 최적화가 시급합니다.</li>
                <li><strong>Z드라이브 모니터링:</strong> Z드라이브 사용률이 87.77%로 임계치에 근접했습니다. 스토리지 확장 계획 수립을 권장합니다.</li>
                <li><strong>웹사이트 접근성 개선:</strong> 일부 시간대에 웹사이트 접속 오류가 발생했습니다. 원인 분석 및 개선이 필요합니다.</li>
                <li><strong>Agent 모니터링 강화:</strong> Agent가 간헐적으로 unavailable 상태가 됩니다. Agent 상태 모니터링을 강화하세요.</li>
            </ul>
        </div>

        <footer>
            <p>본 보고서는 NMSGLOBAL NMS 시스템 데이터를 기반으로 작성되었습니다.</p>
            <p>© 2025 시스템 관리팀. 모든 권리 보유.</p>
        </footer>
    </div>

    <script>
        // 날짜 데이터 설정
        const today = new Date();
        const last7Days = [];
        const formattedDates = [];

        for (let i = 6; i >= 0; i--) {
            const date = new Date();
            date.setDate(today.getDate() - i);
            const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            const displayDate = `${String(date.getMonth() + 1).padStart(2, '0')}/${String(date.getDate()).padStart(2, '0')}`;
            last7Days.push(formattedDate);
            formattedDates.push(displayDate);
        }

        // 보고서 기간 및 생성일 설정
        document.getElementById('reportPeriod').textContent = `${last7Days[0]} ~ ${last7Days[6]}`;
        document.getElementById('generatedDate').textContent = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;

        // 실제 데이터 기반 설정
        const memoryUsage = [68.13, 70.09, 73.22, 74.38, 75.44, 76.37, 80.07];
        const virtualMemoryUsage = [60.03, 63.49, 65.94, 66.77, 68.28, 69.23, 70.9];
        const cDriveUsage = [96.53, 96.57, 96.58, 96.54, 96.59, 96.7, 96.58];
        const zDriveUsage = [86.34, 86.31, 86.31, 86.31, 86.31, 87.77, 87.77];
        const serviceStatus = [4, 4, 4, 4, 4, 4, 4];

        // 차트 색상 설정
        const chartColors = {
            blue: 'rgba(54, 162, 235, 0.7)',
            blueLight: 'rgba(54, 162, 235, 0.4)',
            green: 'rgba(75, 192, 192, 0.7)',
            greenLight: 'rgba(75, 192, 192, 0.4)',
            red: 'rgba(255, 99, 132, 0.7)',
            redLight: 'rgba(255, 99, 132, 0.4)',
            yellow: 'rgba(255, 205, 86, 0.7)',
            yellowLight: 'rgba(255, 205, 86, 0.4)',
            purple: 'rgba(153, 102, 255, 0.7)',
            purpleLight: 'rgba(153, 102, 255, 0.4)',
            orange: 'rgba(255, 159, 64, 0.7)',
            orangeLight: 'rgba(255, 159, 64, 0.4)'
        };

        // 메모리 사용률 차트
        new Chart(document.getElementById('memoryChart'), {
            type: 'line',
            data: {
                labels: formattedDates,
                datasets: [{
                    label: '메모리 사용률 (%)',
                    data: memoryUsage,
                    fill: true,
                    backgroundColor: chartColors.redLight,
                    borderColor: chartColors.red,
                    tension: 0.3,
                    pointRadius: 5,
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: '메모리 사용률 추이',
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        min: 65,
                        max: 85,
                        title: {
                            display: true,
                            text: '사용률 (%)'
                        }
                    }
                }
            }
        });

        // 드라이브 사용률 차트
        new Chart(document.getElementById('driveChart'), {
            type: 'line',
            data: {
                labels: formattedDates,
                datasets: [
                    {
                        label: 'C드라이브 사용률 (%)',
                        data: cDriveUsage,
                        fill: true,
                        backgroundColor: chartColors.redLight,
                        borderColor: chartColors.red,
                        tension: 0.3,
                        pointRadius: 4
                    },
                    {
                        label: 'Z드라이브 사용률 (%)',
                        data: zDriveUsage,
                        fill: true,
                        backgroundColor: chartColors.orangeLight,
                        borderColor: chartColors.orange,
                        tension: 0.3,
                        pointRadius: 4
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: '드라이브 사용률 추이',
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        min: 85,
                        max: 100,
                        title: {
                            display: true,
                            text: '사용률 (%)'
                        }
                    }
                }
            }
        });

        // 가상 메모리 사용률 차트
        new Chart(document.getElementById('virtualMemoryChart'), {
            type: 'line',
            data: {
                labels: formattedDates,
                datasets: [{
                    label: '가상 메모리 사용률 (%)',
                    data: virtualMemoryUsage,
                    fill: true,
                    backgroundColor: chartColors.purpleLight,
                    borderColor: chartColors.purple,
                    tension: 0.3,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: '가상 메모리 사용률 추이',
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        min: 55,
                        max: 75,
                        title: {
                            display: true,
                            text: '사용률 (%)'
                        }
                    }
                }
            }
        });

        // 서비스 상태 차트
        new Chart(document.getElementById('servicesChart'), {
            type: 'bar',
            data: {
                labels: formattedDates,
                datasets: [
                    {
                        label: '정상 작동 서비스',
                        data: serviceStatus,
                        backgroundColor: chartColors.green,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: '주요 서비스 가동 현황',
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 5,
                        title: {
                            display: true,
                            text: '서비스 개수'
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>